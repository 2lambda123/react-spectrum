{/* Copyright 2020 Adobe. All rights reserved.
This file is licensed to you under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License. You may obtain a copy
of the License at http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software distributed under
the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
OF ANY KIND, either express or implied. See the License for the specific language
governing permissions and limitations under the License. */}

import {Layout} from '@react-spectrum/docs';
export default Layout;

import docs from 'docs:@react-spectrum/card';
import cardViewTypes from 'docs:@react-types/card/src/index.d.ts';
import {HeaderInfo, PropTable, PageDescription, TypeLink, ClassAPI, FunctionAPI, InterfaceType, TypeContext} from '@react-spectrum/docs';
import packageData from '@react-spectrum/card/package.json';

```jsx import
import {Card, CardView, GalleryLayout, GridLayout, WaterfallLayout} from '@react-spectrum/card';
import {Flex} from '@react-spectrum/layout';
```

---
category: Collections
keywords: [cardview, gallery, grid, waterfall, tile]
after_version: 3.0.0-beta.0
---

# CardView

<PageDescription>{docs.exports.CardView.description}</PageDescription>

<HeaderInfo
  packageData={packageData}
  componentNames={['Card', 'CardView', 'GalleryLayout', 'GridLayout', 'WaterfallLayout']} />

## Example
```tsx example
import {Content} from '@react-spectrum/view';
import {Heading, Text} from '@react-spectrum/text';
import {Image} from '@react-spectrum/image';

<CardView height="380px" width="100%" layout={GridLayout} aria-label="Static CardView example">
  <Card key="1" width={1024} height={683} textValue="Shaggy Horse">
    <Image src="https://lfdanlu.github.io/docPhotos/photos/DSC00527.jpeg" />
    <Heading>Shaggy Horse</Heading>
    <Text slot="detail">JPEG</Text>
    <Content>Size: 366 KB</Content>
  </Card>
  <Card key="2" width={1024} height={683} textValue="Lighthouse">
    <Image src="https://lfdanlu.github.io/docPhotos/photos/DSC00591.jpeg" />
    <Heading>Lighthouse</Heading>
    <Text slot="detail">JPEG</Text>
    <Content>Size: 182 KB</Content>
  </Card>
  <Card key="3" width={1024} height={683} textValue="Waterfall">
    <Image src="https://lfdanlu.github.io/docPhotos/photos/DSC00827.jpeg" />
    <Heading>Waterfall</Heading>
    <Text slot="detail">JPEG</Text>
    <Content>Size: 182 KB</Content>
  </Card>
</CardView>
```

## Content
CardView is a collection component that displays a collection of cards in a variety of layouts. It follows the [Collection Components](../react-stately/collections.html) API, accepting both static and dynamic collections.
It expects `<Card>` elements as children, which in turn accept a variety of other content elements as described [here](#cards). Static collections, as in the previous example, can be used when the full list of cards is known ahead of time.

Dynamic collections, as shown below, can be used when the card data comes from an external data source such as an API call, or update over time. Providing the data in this way allows CardView to automatically cache the rendering of each item, which dramatically improves performance.

Each card has a unique key defined by the data. In the example below, the `key` of each card is implicitly defined by the id property of the item object. See [collections](../react-stately/collections.html#unique-keys) to learn more keys in dynamic collections.

```tsx example
let items = [
  {id: 1, name: 'Shaggy Horse', size: '366 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00527.jpeg'},
  {id: 2, name: 'Lighthouse', size: '182 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00591.jpeg'},
  {id: 3, name: 'Waterfall', size: '182 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00827.jpeg'}
];

<CardView items={items} height="380px" width="100%" layout={GridLayout} aria-label="Dynamic CardView example">
  {item => (
    <Card textValue={item.name} width={item.width} height={item.height}>
      <Image src={item.src} />
      <Heading>{item.name}</Heading>
      <Text slot="detail">JPEG</Text>
      <Content>Size: {item.size}</Content>
    </Card>
  )}
</CardView>
```

### Cards
A standard Card consists of a preview image and a title, and allows for an optional detail area next to the title and an optional content area immediately below the
title. The image, title, and content area can be populated by providing an [Image](Image.html), [Heading](Heading.html), and [Content](Content.html) respectively as children to
the Card. The detail area can be populated through a [Text](Text.html) element with an accompanying `slot="detail"` prop.

Please note that a Spectrum compliant Card should not contain focusable or interactive content within the content area and that the content itself should only display the most essential pieces of information.
If you need to perform actions on a card, please use the ActionBar component in lieu of adding an action menu to the Card itself. See the [Card Actions](#card-actions) section for an example.

The properties that the Card supports can be found in the [Props](#props) table below. Note that the `height` and `width` props refer to the image's height and width, not the Card's height and
width. These values are used to calculate the proper positioning and size of each card within the CardView's container.

### Internationalization
To internationalize a CardView, all text content within the Cards should be localized. The `aria-label` provided to the CardView should also be localized any.
For languages that are read right-to-left (e.g. Hebrew and Arabic), the layout of CardView is automatically flipped.

## Layout
CardView supports three different visual layouts: <TypeLink links={docs.links} type={docs.exports.GridLayout} />, <TypeLink links={docs.links} type={docs.exports.GalleryLayout} />
and <TypeLink links={docs.links} type={docs.exports.WaterfallLayout} />. You can set the CardView's layout by passing the imported class directly to the `layout` prop as shown in the previous examples.
This will handle instantiating the layout class with its default options. Alternatively, you can modify the layout's various options (e.g. margins, item sizes, etc) by constructing your own instance of the
class and providing that to the CardView instead.

The example below demonstrates the differences between each of the layouts as well as showing how you could instantiate a layout instance.

```tsx example
import {ActionGroup, Item} from '@react-spectrum/actiongroup';
import {Flex} from '@react-spectrum/layout';
import {useProvider} from '@react-spectrum/provider';

function LayoutDemo() {
  let items = [
    {width: 1001, height: 381, src: 'https://i.imgur.com/Z7AzH2c.jpg', title: 'Temple Roof', ext: 'JPG'},
    // ...
    ///- begin collapse -///
    {width: 640, height: 640, src: 'https://i.imgur.com/DhygPot.jpg', title: 'Starry Sky', ext: 'JPG'},
    {width: 1516, height: 1009, src: 'https://i.imgur.com/1nScMIH.jpg', title: 'Molten glass', ext: 'JPG'},
    {width: 1215, height: 121, src: 'https://i.imgur.com/zzwWogn.jpg', title: 'Mountain Range', ext: 'JPG'}
    ///- end collapse -///
  ];

  let {scale} = useProvider();
  let gridLayout = React.useMemo(() => new GridLayout({scale}), [scale]);
  let galleryLayout = React.useMemo(() => new GalleryLayout({scale}), [scale]);
  let waterfallLayout = React.useMemo(() => new WaterfallLayout({scale}), [scale]);
  let [layout, setLayout] = React.useState(gridLayout);
  let onAction = (key) => {
    if (key === 'grid') {
      setLayout(gridLayout);
    } else if (key === 'gallery') {
      setLayout(galleryLayout);
    } else {
      setLayout(waterfallLayout);
    }
  };

  return (
    <Flex direction="column" height="600px" width="100%">
      <ActionGroup defaultSelectedKeys={['grid']} selectionMode="single" disallowEmptySelection onAction={onAction} aria-label="CardView layout selection">
        <Item key="grid">Grid layout</Item>
        <Item key="gallery">Gallery layout</Item>
        <Item key="waterfall">Waterfall layout</Item>
      </ActionGroup>
      <CardView items={items} layout={layout} width="100%" height="100%" aria-label="CardView with changeable layout">
        {item => (
          <Card key={item.title} textValue={item.title} width={item.width} height={item.height}>
            <Image src={item.src} />
            <Heading>{item.title}</Heading>
            <Text slot="detail">{item.ext}</Text>
            <Content>Image dimensions: {item.width}x{item.height}</Content>
          </Card>
        )}
      </CardView>
    </Flex>
  );
}
```

### GridLayout
As can be seen above, the GridLayout renders each card with a uniform height and width regardless of the image size. The customizable options available to the GridLayout are as follows:

- `minItemSize`
- `maxItemSize`
- `minSpace`
- `maxColumns`
- `itemPadding`
- `cardOrientation`

### GalleryLayout
The GalleryLayout arranges each card in such a way that each card in a row shares the same height but has a width that accommodates the image's
aspect ratio. The layout will attempt to take up all available space in the CardView and thus will distribute the cards in each row accordingly.
The customizable options available to the GalleryLayout are as follows:

- `minItemSize`
- `idealRowHeight`
- `itemSpacing`
- `itemPadding`
- `threshold`

### WaterfallLayout
The WaterfallLayout organizes the cards into equal width columns but allows each card to have a variable height. Similarly to GalleryLayout, it attempts to accommodate
the aspect ratio of each card's image. The customizable options available to the WaterfallLayout are as follows:

- `minItemSize`
- `maxItemSize`
- `minSpace`
- `maxColumns`
- `itemPadding`

## Labeling
### Accessibility
An `aria-label` must be provided to the CardView for accessibility. If the CardView is labeled by a separate element, an `aria-labelledby` prop must be provided using the id of the labeling element instead.

## Asynchronous loading
CardView supports loading data asynchronously, and will display a progress circle reflecting the current load state,
set by the `loadingState` prop. It also supports infinite scrolling to load more data on demand as the user scrolls, via the `onLoadMore` prop.

This example uses the [useAsyncList](../react-stately/useAsyncList.html) hook to handle loading the data.
See the docs for more information.

```tsx example
import {useAsyncList} from '@react-stately/data';

async function getImageData(page) {
  // Mock function for getting paged data...
  ///- begin collapse -///
  let data = [
    {id: 1, name: 'Icy Peak', size: '206 KB', width: 670, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00888.jpeg', ext: 'JPEG'},
    {id: 2, name: 'Grassy Plain', size: '233 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01051.jpeg', ext: 'JPEG'},
    {id: 3, name: 'Glacier', size: '198 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01062.jpeg', ext: 'JPEG'},
    {id: 4, name: 'Castle', size: '286 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01817.jpeg', ext: 'JPEG'},
    {id: 5, name: 'Panorama', size: '156 KB', width: 1024, height: 367, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01822-Pano.jpeg', ext: 'JPEG'},
    {id: 6, name: 'Cliffside', size: '1.6 MB', width: 825, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC03438.jpeg', ext: 'JPEG'},
    {id: 7, name: 'Shaggy Horse', size: '366 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00527.jpeg', ext: 'JPEG'},
    {id: 8, name: 'Lighthouse', size: '182 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00591.jpeg', ext: 'JPEG'},
    {id: 9, name: 'Waterfall', size: '182 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00827.jpeg', ext: 'JPEG'},
    {id: 10, name: 'Temple Roof', size: '123 KB', width: 1001, height: 381, src: 'https://i.imgur.com/Z7AzH2c.jpg',  ext: 'JPG'},
    {id: 11, name: 'Starry Sky', size: '231 KB', width: 640, height: 640, src: 'https://i.imgur.com/DhygPot.jpg',  ext: 'JPG'},
    {id: 12, name: 'Molten glass', size: '173 KB', width: 1516, height: 1009, src: 'https://i.imgur.com/1nScMIH.jpg',  ext: 'JPG'},
    {id: 13, name: 'Mountain Range', size: '623 KB', width: 1215, height: 121, src: 'https://i.imgur.com/zzwWogn.jpg',  ext: 'JPG'}
  ];

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve({result: data.slice((page - 1) * 4, page * 4), cursor: page < 4 ? page + 1 : null});
    }, 2000);
  });
  ///- end collapse -///
}

function AsyncLoadingCardView() {
  let list = useAsyncList({
    async load({cursor}) {
      let res = await getImageData(cursor || 1);
      return {
        items: res.result,
        cursor: res.cursor
      };
    }
  });

  return (
    <CardView items={list.items} onLoadMore={list.loadMore} loadingState={list.loadingState} layout={GridLayout} width="100%" height="500px" aria-label="Async loading CardView">
      {item => (
        <Card key={item.title} textValue={item.title}>
          <Image src={item.src} />
          <Heading>{item.name}</Heading>
          <Text slot="detail">{item.ext}</Text>
          <Content>Size: {item.size}</Content>
        </Card>
      )}
    </CardView>
  );
}

<AsyncLoadingCardView />
```

## Selection
By default, CardView doesn't allow card selection but this can be enabled using the `selectionMode` prop.
Use `defaultSelectedKeys` to provide a default set of selected Cards. Note that the value of the selected keys must match the `key` prop of the card.

The example below enables multiple selection mode, and uses `defaultSelectedKeys` to select the Cards with keys 2 and 4.

```tsx example
let items = [
  {id: 1, name: 'Icy Peak', size: '206 KB', width: 670, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00888.jpeg'},
  {id: 2, name: 'Grassy Plain', size: '233 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01051.jpeg'},
  // ...
  ///- begin collapse -///
  {id: 3, name: 'Glacier', size: '198 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01062.jpeg'},
  {id: 4, name: 'Castle', size: '286 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01817.jpeg'},
  {id: 5, name: 'Panorama', size: '156 KB', width: 1024, height: 367, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01822-Pano.jpeg'},
  {id: 6, name: 'Cliffside', size: '1.6 MB', width: 825, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC03438.jpeg'}
  ///- end collapse -///
];

<CardView items={items} height="500px" width="100%" layout={GridLayout} aria-label="Default selection CardView example" selectionMode="multiple" defaultSelectedKeys={[2, 4]}>
  {item => (
    <Card textValue={item.name} width={item.width} height={item.height}>
      <Image src={item.src} />
      <Heading>{item.name}</Heading>
      <Text slot="detail">JPEG</Text>
      <Content>Size: {item.size}</Content>
    </Card>
  )}
</CardView>
```

### Controlled selection
To programmatically control card selection, use the `selectedKeys` prop paired with the `onSelectionChange` callback. The `key` prop from the selected card will
be passed into the callback when the card is pressed, allowing you to update state accordingly.

Here is how you would control selection for the above example.

```tsx example export=true
function SelectionCardView(props) {
  let items = [
    // Same items as in the previous...
    ///- begin collapse -///
    {id: 1, name: 'Icy Peak', size: '206 KB', width: 670, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00888.jpeg'},
    {id: 2, name: 'Grassy Plain', size: '233 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01051.jpeg'},
    {id: 3, name: 'Glacier', size: '198 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01062.jpeg'},
    {id: 4, name: 'Castle', size: '286 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01817.jpeg'},
    {id: 5, name: 'Panorama', size: '156 KB', width: 1024, height: 367, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01822-Pano.jpeg'},
    {id: 6, name: 'Cliffside', size: '1.6 MB', width: 825, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC03438.jpeg'}
    ///- end collapse -///
  ];
  let [selectedKeys, setSelectedKeys] = React.useState(new Set([2]));

  return (
    <CardView items={items} height="500px" width="100%" layout={GridLayout} aria-label="Controlled selection CardView example" selectionMode="multiple" selectedKeys={selectedKeys} onSelectionChange={setSelectedKeys} {...props}>
      {item => (
        <Card textValue={item.name} width={item.width} height={item.height}>
          <Image src={item.src} />
          <Heading>{item.name}</Heading>
          <Text slot="detail">JPEG</Text>
          <Content>Size: {item.size}</Content>
        </Card>
      )}
    </CardView>
  );
}
```

### Single selection
To limit users to selecting only a single card at a time, `selectionMode` can be set to `single`.

```tsx example
// Using the same CardView as above
<SelectionCardView selectionMode="single" />
```

### Disallow empty selection
CardView also supports a `disallowEmptySelection` prop which forces the user to have at least one Card in the CardView selected at all times.
In this mode, if a single card is selected and the user presses it, it will not be deselected.

```tsx example
// Using the same CardView as above
<SelectionCardView disallowEmptySelection />
```

### Disabled cards
You can disable specific card by providing an array of keys to CardView via the `disabledKeys` prop. This will prevent cards from being selectable as shown in the example below.

```tsx example
function CardViewDisabledKeys() {
  let items = [
    {id: 1, name: 'Icy Peak', type: 'image', size: '198 KB', width: 670, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00888.jpeg'},
    {id: 2, name: 'Saved Photos 20222', type: 'folder', size: '1.3 GB'},
    ///- begin collapse -///
    {id: 3, name: 'Glacier', size: '198 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01062.jpeg'},
    {id: 4, name: 'Castle', size: '286 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01817.jpeg'},
    {id: 5, name: 'Panorama', size: '156 KB', width: 1024, height: 367, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01822-Pano.jpeg'},
    {id: 6, name: 'Cliffside', size: '1.6 MB', width: 825, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC03438.jpeg'}
    ///- end collapse -///
  ];

  return (
    <CardView items={items} height="500px" width="100%" layout={GridLayout} aria-label="Disabled selection CardView example" selectionMode="multiple" disabledKeys={[2]}>
      {item => (
        <Card textValue={item.name} >
          <Image src={item.src} />
          <Heading>{item.name}</Heading>
          <Content>Size: {item.size}</Content>
        </Card>
      )}
    </CardView>
  );
}
```

TODO: add example w/ folders and items. Have items be the images already used, and find a stock folder image/try icon?

### Card actions
A common use case is to allow a user to perform actions on one or more cards. The example below illustrates how one could use ActionBar to trigger an action on the
currently selected card.

```tsx example
import {ActionBar, ActionBarContainer, Item} from '@react-spectrum/actionbar';
import Copy from '@spectrum-icons/workflow/Copy';
import Delete from '@spectrum-icons/workflow/Delete';
import Edit from '@spectrum-icons/workflow/Edit';

let items = [
  // Same items as in the selection examples...
  ///- begin collapse -///
  {id: 1, name: 'Icy Peak', size: '206 KB', width: 670, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC00888.jpeg'},
  {id: 2, name: 'Grassy Plain', size: '233 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01051.jpeg'},
  {id: 3, name: 'Glacier', size: '198 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01062.jpeg'},
  {id: 4, name: 'Castle', size: '286 KB', width: 1024, height: 683, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01817.jpeg'},
  {id: 5, name: 'Panorama', size: '156 KB', width: 1024, height: 367, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC01822-Pano.jpeg'},
  {id: 6, name: 'Cliffside', size: '1.6 MB', width: 825, height: 1005, src: 'https://lfdanlu.github.io/docPhotos/photos/DSC03438.jpeg'}
  ///- end collapse -///
];

function CardViewActions() {
  let [selectedKeys, setSelectedKeys] = React.useState(new Set([2]));

  return (
    <ActionBarContainer height="500px">
      <CardView items={items} selectedKeys={selectedKeys} onSelectionChange={setSelectedKeys} height="500px" width="100%" layout={GridLayout} aria-label="CardView with ActionBar example" selectionMode="multiple">
        {item => (
          <Card textValue={item.name} width={item.width} height={item.height}>
            <Image src={item.src} />
            <Heading>{item.name}</Heading>
            <Text slot="detail">PNG</Text>
            <Content>{item.type}</Content>
          </Card>
        )}
      </CardView>
      <ActionBar
        isEmphasized
        selectedItemCount={selectedKeys.size}
        onClearSelection={() => {
          setSelectedKeys(new Set());
        }}
        onAction={key => alert(`Performing ${key} action on ${selectedKeys.size} cards.`)}>
        <Item key="edit">
          <Edit />
          <Text>Edit</Text>
        </Item>
        <Item key="copy">
          <Copy />
          <Text>Copy</Text>
        </Item>
        <Item key="delete">
          <Delete />
          <Text>Delete</Text>
        </Item>
      </ActionBar>
    </ActionBarContainer>
  );
}

<CardViewActions />
```

## Props

### CardView props

<PropTable component={docs.exports.CardView} links={docs.links} style={{marginBottom: '40px'}} />

### Card props

<PropTable component={{
  props: {
    properties: Object.fromEntries(Object.entries(cardViewTypes.exports.CardViewCardProps.properties))
  }
}} links={cardViewTypes.links} />

## Visual options

### Horizontal Cards
GridLayout is the only layout that currently supports horizontal cards. To enable horizontal cards, provide `cardOrientation="horizontal"`
to the CardView and to your GridLayout instance if you are instantiating one.

```tsx example
// Same CardView from controlled selection example...
<SelectionCardView layout={GridLayout} aria-label="CardView with horizontal cards" height="300px" cardOrientation="horizontal" />
```

### Quiet
WaterfallLayout is the only layout that currently supports quiet cards. To enable quiet cards, provide `isQuiet`
to the CardView.

```tsx example
// Same CardView from controlled selection example...
<SelectionCardView layout={WaterfallLayout} aria-label="CardView with quiet cards" isQuiet />
```

### Empty state
Use the `renderEmptyState` prop to customize what the CardView will display if there are no cards provided.

```tsx example
import {Content} from '@react-spectrum/view';
import {IllustratedMessage} from '@react-spectrum/illustratedmessage';
import NotFound from '@spectrum-icons/illustrations/NotFound';
import {Heading} from '@react-spectrum/text';

function renderEmptyState() {
  return (
    <IllustratedMessage>
      <NotFound />
      <Heading>No results</Heading>
      <Content>No results found</Content>
    </IllustratedMessage>
  );
}

<CardView aria-label="Example CardView for empty state" height="size-3000" layout={GridLayout} renderEmptyState={renderEmptyState}>
  {[]}
</CardView>
```
