{/* Copyright 2023 Adobe. All rights reserved.
This file is licensed to you under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License. You may obtain a copy
of the License at http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software distributed under
the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
OF ANY KIND, either express or implied. See the License for the specific language
governing permissions and limitations under the License. */}

import {ExampleLayout} from '@react-spectrum/docs';
export default ExampleLayout;

import docs from 'docs:react-aria-components';
import {TypeLink} from '@react-spectrum/docs';
import styles from '@react-spectrum/docs/src/docs.css';
import Tabs from '@react-spectrum/docs/pages/assets/component-illustrations/Tabs.svg';
import {ExampleCard} from '@react-spectrum/docs/src/ExampleCard';

---
keywords: [example, calendar, aria, accessibility, react, component]
type: component
image: swipeable-tabs.png
description: A swipeable Tabs component built with Framer Motion and CSS scroll snapping.
---

# Swipeable Calendar

A swipeable [Tabs](Tabs.html) component built with with React Aria Components, [Framer Motion](https://www.framer.com/motion/), [Tailwind CSS](https://tailwindcss.com/), and [CSS scroll snapping](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_scroll_snap).

## Example

```tsx import
import './tailwind.global.css';
```

```tsx example flip
import {
  animate,
  motion,
  useDragControls,
  useMotionValue,
  ValueAnimationTransition
} from "framer-motion";
import {
  Button,
  Calendar,
  CalendarCell,
  CalendarGrid,
  CalendarGridBody,
  CalendarGridHeader,
  CalendarHeaderCell,
  Heading
} from "react-aria-components";
import type {ButtonProps} from 'react-aria-components';
import ChevronLeftIcon from '@spectrum-icons/workflow/ChevronLeft';
import ChevronRightIcon from '@spectrum-icons/workflow/ChevronRight';
import { ReactNode, useCallback, useEffect, useRef, useState } from "react";

function AnimatedCalendar() {
  // Store the number of pages we've navigated left or right from where we started.
  let [pageOffset, setPageOffset] = useState(0);

  return (
    <Calendar
      aria-label="Appointment date"
      className="pt-4 sm:max-w-[300px] -mx-[14px] sm:mx-auto">
      {({state}) => (
        <>
          <header className="flex items-center pb-4 px-2 w-full box-border">
            <RoundButton
              slot="previous"
              onPress={() => {
                state.focusPreviousPage();
                setPageOffset(pageOffset - 1);
              }}>
              <ChevronLeftIcon size="S" />
            </RoundButton>
            <Heading className="flex-1 text-center font-semibold text-xl" />
            <RoundButton
              slot="next"
              onPress={() => {
                state.focusNextPage();
                setPageOffset(pageOffset + 1);
              }}>
              <ChevronRightIcon size="S" />
            </RoundButton>
          </header>
          <Carousel
            pageOffset={pageOffset}
            onNext={() => {
              state.focusNextPage();
              setPageOffset(pageOffset + 1);
            }}
            onPrevious={() => {
              state.focusPreviousPage();
              setPageOffset(pageOffset - 1);
            }}>
            {(offset) => (
              <Month
                key={state.visibleRange.start
                  .add({ months: offset })
                  .toString()}
                offset={offset}
              />
            )}
          </Carousel>
        </>
      )}
    </Calendar>
  );
}

function Month({ offset }: { offset: number }) {
  return (
    <CalendarGrid
      offset={{ months: offset }}
      className="border-spacing-0 border-separate w-full h-[330px] sm:h-[280px]">
      <CalendarGridHeader>
        {(day) => (
          <CalendarHeaderCell className="text-sm text-gray-500 dark:text-gray-400 font-semibold">
            {day}
          </CalendarHeaderCell>
        )}
      </CalendarGridHeader>
      <CalendarGridBody>
        {(date) => (
          <CalendarCell
            date={date}
            className="mx-auto w-full aspect-square outline-none cursor-default rounded-full text-md flex items-center justify-center outside-month:text-gray-300 dark:outside-month:text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-800 pressed:bg-gray-200 dark:pressed:bg-gray-700 selected:bg-black dark:selected:bg-white selected:text-white dark:selected:text-black focus-visible:ring ring-black dark:ring-white ring-offset-2 ring-offset-[--spectrum-gray-200]" />
        )}
      </CalendarGridBody>
    </CalendarGrid>
  );
}

interface CarouselProps {
  pageOffset: number;
  children: (offset: number) => ReactNode;
  onNext: () => void;
  onPrevious: () => void;
}

const inertiaTransition: ValueAnimationTransition = {
  type: "inertia",
  bounceStiffness: 300,
  bounceDamping: 40,
  timeConstant: 300
};

const staticTransition: ValueAnimationTransition = {
  duration: 0.5,
  ease: [0.32, 0.72, 0, 1]
};

function Carousel({ pageOffset, children, onNext, onPrevious }: CarouselProps) {
  let ref = useRef<HTMLDivElement>(null);
  let x = useMotionValue(0);

  const animateToPage = useCallback(
    (index: number) => {
      // Animate to the new page. Use inertia if the velocity is not zero (e.g. when swiping),
      // otherwise use a static transition (e.g. when next/previous buttons are clicked).
      let pos = -index * ref.current!.clientWidth ?? 0;
      return animate(
        x,
        pos,
        x.getVelocity() !== 0
          ? {
              ...inertiaTransition,
              min: pos,
              max: pos
            }
          : staticTransition
      );
    },
    [x]
  );

  useEffect(() => {
    x.stop();
    const controls = animateToPage(pageOffset);
    return controls?.stop;
  }, [pageOffset, animateToPage, x]);

  let drag = useDragControls();

  return (
    <div ref={ref} className="relative overflow-hidden touch-none">
      <motion.div
        style={{ x }}
        drag="x"
        dragElastic={1}
        whileDrag={{
          // Disable hover styles on cells while dragging.
          pointerEvents: "none"
        }}
        dragListener={false}
        dragControls={drag}
        onPointerDownCapture={(e) => {
          // Only start dragging on touch devices.
          if (e.pointerType === "touch") {
            drag.start(e);
          }
        }}
        onDragStart={() => {
          // Cancel react-aria press event on date cell when dragging starts.
          document.dispatchEvent(new PointerEvent("pointercancel"));
        }}
        onDragEnd={(e, { offset, velocity }) => {
          // Change page if the user drags most of the way to the next page,
          // or the velocity is greater than some threshold. Otherwise,
          // animate back to the current page.
          const threshold = ref.current!.clientWidth * 0.6;
          if (offset.x > threshold || velocity.x > 10) {
            onPrevious();
          } else if (offset.x < -threshold || velocity.x < -10) {
            onNext();
          } else {
            animateToPage(pageOffset);
          }
        }}>
        {/* The current page is relative, and the others are absolute. This makes width: fit-content work. */}
        <Page index={pageOffset - 1} className="absolute" inert="true">
          {children(-1)}
        </Page>
        <Page index={pageOffset} className="relative">
          {children(0)}
        </Page>
        <Page index={pageOffset + 1} className="absolute" inert="true">
          {children(1)}
        </Page>
      </motion.div>
    </div>
  );
}

interface PageProps {
  index: number;
  children: ReactNode;
  className: string;
  inert?: string;
}

function Page({ index, children, className, ...otherProps }: PageProps) {
  return (
    <div
      className={`${className} top-0 w-full`}
      style={{ left: `${index * 100}%` }}
      {...otherProps}>
      {children}
    </div>
  );
}

function RoundButton(props: ButtonProps) {
  return <Button {...props} className="w-10 h-10 outline-none cursor-default border-none rounded-full flex items-center justify-center bg-transparent text-black dark:text-white hover:bg-gray-100 dark:hover:bg-gray-800 pressed:bg-gray-200 dark:pressed:bg-gray-700 focus-visible:ring ring-black dark:ring-white ring-offset-2 ring-offset-[--spectrum-gray-200]" />;
}
```

## Components

<section className={styles.cardGroup} data-size="small">

<ExampleCard
  url="../Tabs.html"
  title="Tabs"
  description="Tabs organize content into multiple sections, and allow a user to view one at a time.">
  <Tabs />
</ExampleCard>

</section>
